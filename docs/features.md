<sup>[← Back to home](https://publicsatanicvoid.github.io/WindowsPowerWash/)</sup>

## How It Works
The default Windows installation has to cater to a very wide variety of users, and generally makes tradeoffs that sacrifice some degree of performance and responsiveness in exchange for power management, data collection, etc.

PowerWash modifies various aspects of your Windows installation. It configures your system to aggressively choose maximum performance and minimum latency over power saving. (Note: Many of the changes intentionally do not apply when on battery). It also removes bloatware and unwanted default programs, and generally cleans up the out-of-box experience. It does this through a combination of registry changes, application package removals, PowerShell cmdlets, and more.

### Highlights

These are some of the most commonly wanted modifications to a standard Windows install, and PowerWash has all of them!
- Disable Microsoft **[telemetry](https://learn.microsoft.com/en-us/windows/privacy/configure-windows-diagnostic-data-in-your-organization#diagnostic-data-settings)** / "phoning home"
- Disable **[automatic updates](https://learn.microsoft.com/en-us/windows/deployment/update/waas-wu-settings#configuring-automatic-updates-by-editing-the-registry)**
- Remove useless or unwanted **[preinstalled applications](https://www.howtogeek.com/163303/how-computer-manufacturers-are-paid-to-make-your-laptop-worse/)** -- including **Microsoft Edge**, if desired
- Throttle "**[MsMpEng.exe](https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2019-ps#-scanavgcpuloadfactor)**" / "Antimalware Service Executable"
- Configure and activate **[maximum performance](https://social.technet.microsoft.com/wiki/contents/articles/52059.windows-10-the-ultimate-performance-power-policy.aspx)** power settings
- Harden your device with **advanced security configuration** incorporating key settings from the NSA Secure Host Baseline, Microsoft Defender for Endpoint Security Recommendations, and a wide range of Windows Process Mitigations.
- Toggle **[soft real-time scheduling](https://learn.microsoft.com/en-us/windows/iot/iot-enterprise/soft-real-time/soft-real-time)** for IoT Enterprise SKUs (standalone scripts [here](https://github.com/PublicSatanicVoid/WindowsPowerWash/tree/main/extra))

## Full Listing

*Note that some editions of Windows do not have the necessary components to support certain PowerWash features. PowerWash does not impose any artificial limitations and the author continues to look for ways around Microsoft's. All features listed below are optional and configurable using the provided [`PowerWashSettings.yml`](https://github.com/PublicSatanicVoid/WindowsPowerWash/tree/main/PowerWashSettings.yml). (See [the documentation](https://publicsatanicvoid.github.io/WindowsPowerWash/docs/usage/config)).*

✅ = Fully supported, ℹ = Partially supported, ✅ℹ = Fully supported but may require additional software, ⚠️ = Fully supported but caution encouraged, ❌ = Not supported

### System Configuration - Performance

| Feature                             | Works on Windows Home | Works on Windows Pro, Pro for Workstations | Works on Windows Enterprise, Enterprise LTSC, Education | Description                                                                                                                                                                                                                                                                                                                                                                 |
| ----------------------------------- | :-------------------: | :------------------: | :-----------------------------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Disable HPET                        |           ✅           |          ✅           |                   ✅                   | Disabling the [high precision event timer](https://en.wikipedia.org/wiki/High_Precision_Event_Timer) may improve DPC latency on some systems                                                                                                                                                                                                                                |
| Aggressive multimedia settings      |           ✅           |          ✅           |                   ✅                   | Applying more aggressive [multimedia settings](https://learn.microsoft.com/en-us/windows/win32/procthread/multimedia-class-scheduler-service) can improve performance of pro audio tasks                                                                                                                                                                                    |
| Aggressive network adapter settings |           ✅           |          ✅           |                   ✅                   | Disabling network adapter packet coalescing and similar options can improve DPC latency for `ndis.sys`/`tcpip.sys`                                                                                                                                                                                                                                                          |
| "Ultimate" performance power plan   |           ✅           |          ✅           |                   ✅                   | Enables Microsoft's ["Ultimate" performance power plan](https://social.technet.microsoft.com/wiki/contents/articles/52059.windows-10-the-ultimate-performance-power-policy.aspx) along with additional [highly aggressive performance settings](https://learn.microsoft.com/en-us/windows-server/administration/performance-tuning/hardware/power/power-performance-tuning) |
| Accelerated GPU scheduling          |           ✅           |          ✅           |                   ✅                   | Enabling [hardware-accelerated GPU scheduling](https://devblogs.microsoft.com/directx/hardware-accelerated-gpu-scheduling/) can reduce graphics latency                                                                                                                                                                                                                     |
| Higher-performance visual effects | ✅ | ✅ | ✅ | Disables window/tooltip animations and does not render window contents while dragging. Can modestly improve performance and significantly increase perceived responsiveness. Does not disable font smoothing. |
| Disable Fast Startup                |           ✅           |          ✅           |                   ✅                   | Disabling [Fast Startup](https://www.makeuseof.com/what-is-windows-fast-startup-why-disable-it) can fix problems with some devices since Fast Startup skips some initialization                                                                                                                                                                                             |
| Enable message-signaled interrupts  |           ✅           |          ✅           |                   ✅                   | Enabling [message-signaled interrupts](https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-message-signaled-interrupts) on all devices that support them can improve interrupt latency                                                                                                                                                        |
| Prioritize GPU and PCIe controller  |           ✅           |          ✅           |                   ✅                   | May improve DPC/ISR latency for tasks where high regularity is preferred                                                                                                                                                                                                                                                                                                    |
| Disable automatic Windows updates   |           ❌           |          ✅           |                   ✅                   | Background updates can unexpectedly consume resources and automatic install/restart is typically not wanted.                                                                                                                                                                                                                                                                |
| Disable all Windows updates         |           ✅           |          ✅           |                   ✅                   | Completely disables the Windows Update feature, disabling both automatic and manual updates.                                                                                                                                                                                                                                                                                |
| Toggle Windows updates              |           ✅           |          ✅           |                   ✅                   | Adds a script to your desktop to toggle the Windows Update feature on/off. **This is the best compromise for Home editions**                                                                                                                                                                                                                                                |
| Disable Windows consumer features   |           ❌           |          ❌           |                   ✅                   | Disables [Windows consumer features](https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.CloudContent::DisableWindowsConsumerFeatures) (e.g. third-party suggestions)                                                                                                                                                                                     |

### System Configuration - Security

| Feature                                   | Works on Windows Home | Works on Windows Pro, Pro for Workstations | Works on Windows Enterprise, Enterprise LTSC, Education | Description                                                                                                                                                                                                                                                                                                                                                                                                      |
| ----------------------------------------- | :-------------------: | :------------------: | :-----------------------------------: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Apply high-security system settings       |           ℹ           |          ℹ           |                  ✅ℹ                   | Applies security policies recommended by Microsoft Defender for Endpoint, the [MSS Settings](https://techcommunity.microsoft.com/t5/microsoft-security-baselines/the-mss-settings/ba-p/701055), Microsoft's [Security Baselines](https://learn.microsoft.com/en-us/windows/security/operating-system-security/device-management/windows-security-configuration-framework/windows-security-baselines), and the [NSA Secure Host Baseline](https://github.com/nsacyber/Windows-Secure-Host-Baseline), among others. Includes [Attack Surface Reduction](https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction?), [Microsoft Defender Application Guard](https://learn.microsoft.com/en-us/windows/security/application-security/application-isolation/microsoft-defender-application-guard/md-app-guard-overview), browser security, [exploit protection](https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/enable-exploit-protection), [process mitigations](https://learn.microsoft.com/en-us/powershell/module/processmitigations), and much more. Some features require Windows Pro or even Enterprise to take effect. Some features require [Microsoft Endpoint Security](https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/defender-endpoint-plan-1-2). These settings are an addition to, not a replacement for, properly configured antivirus, VPN, firewall, hardware, and good digital hygiene. Now with optional 'strict mode' and 'extra strict mode' for additional protections that may have a more pronounced effect on performance or convenience. (In particular, some aggressive protection settings disable insecure capabilities used by some legitimate applications. If an application refuses to start, or exits with a code you've never seen before after running PowerWash, this is the most likely culprit.) |
| Throttle "Antimalware Service Executable" |           ✅           |          ✅           |                   ✅                   | Configures Windows Defender to only run scans when the computer is idle; reduces priority of Defender tasks and limits their CPU usage                                                                                                                                                                                                                                                                           |
| Disable Defender Real-Time Protection     |           ⚠️           |          ⚠️           |                   ⚠️                   | CAUTION: This will make your device less secure. Requires Tamper Protection to be disabled. Not recommended and still experimental.                                                                                                                                                                                                                                                                              |
| Disable Defender entirely                 |           ⚠️           |          ⚠️           |                   ⚠️                   | CAUTION: This will make your device less secure. Requires Tamper Protection to be disabled. Not recommended and still experimental.                                                                                                                                                                                                                                                                              |
| Disable Windows telemetry                 |           ℹ           |          ℹ           |                   ✅                   | Through Microsoft approved means, Home edition can disable some telemetry, Pro edition can disable most telemetry, and Enterprise/Education can disable all telemetry. However, by disabling the relevant services/tasks, we can effectively (but likely with side effects like wasted resources) disable telemetry completely on any edition.                                                                   |

### System Configuration - Usability

| Feature                                           | Works on Windows Home | Works on Windows Pro, Pro for Workstations | Works on Windows Enterprise, Enterprise LTSC, Education | Description                                    |
| ------------------------------------------------- | :-------------------: | :------------------: | :-----------------------------------: | ---------------------------------------------- |
| Show seconds in taskbar clock                     |           ✅           |          ✅           |                   ✅                   |                                                |
| Show "Run as different user" in Start menu        |           ✅           |          ✅           |                   ✅                   |                                                |
| Show file extensions and hidden items in Explorer |           ✅           |          ✅           |                   ✅                   |                                                |
| Clean up default taskbar                          |           ✅           |          ✅           |                   ✅                   | Mainly geared toward fresh installs of Windows |
| Show UAC Prompt on same desktop                   |           ✅           |           ✅          |                   ✅                   | Shows the UAC Prompt ("Do you want to allow this app to make changes to your device?") on the same desktop you are using, rather than distractingly showing the prompt on a blank desktop. Allegedly this is slightly less secure, but it's also much more convenient. |

### Bloatware Removal

| Feature                          | Works on Windows Home | Works on Windows Pro, Pro for Workstations | Works on Windows Enterprise, Enterprise LTSC, Education | Description                                                                                                                                                                                                                                                                                                           |
| -------------------------------- | :-------------------: | :------------------: | :-----------------------------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Disable/uninstall Cortana        |           ✅           |          ✅           |                   ✅                   | Most people find Cortana a nuisance                                                                                                                                                                                                                                                                                   |
| Remove preinstalled applications |           ✅           |          ✅           |                   ✅                   | Removes Skype, Teams, Xbox, News/Weather, Solitaire Collection, etc. [This list is configurable!](https://publicsatanicvoid.github.io/WindowsPowerWash/docs/usage/config)                                                                                                                                                |
| Remove phantom applications      |           ✅           |          ✅           |                   ✅                   | (BETA) Removes remnants of uninstalled applications from the registry. This can sometimes have a modest impact on performance, e.g. when the system is frequently looking up a large number of paths that don't exist. We can't remove every single reference to the application, but we can clean house quite a bit. |
| Remove Microsoft Edge            |           ✅           |          ✅           |                   ✅                   | Thoroughly removes Microsoft Edge. While some small traces in the filesystem/registry may remain, this removes the vast majority of it and all visible signs. Requires a restart to take full effect. Windows Updates may try to reinstall Edge. This mostly appears to have been fixed, and generally the reinstalled version will be non-functional- it will just show up in the apps list but does not run. You can manually reinstall Edge at any time if you desire. Technical explanation of the removal process is [here](https://publicsatanicvoid.github.io/WindowsPowerWash/docs/removing-edge), for those interested.                                             |
| Remove Microsoft Edge            |           ✅           |          ✅           |                   ✅                   | Thoroughly removes Microsoft Edge. While some small traces in the filesystem/registry may remain, this removes the vast majority of it and all visible signs. Requires a restart to take full effect. Requires SQLite- this will be installed automatically if needed. Windows Updates may try to reinstall Edge. This mostly appears to have been fixed, and generally the reinstalled version will be non-functional- it will just show up in the apps list but does not run. You can manually reinstall Edge at any time if you desire. Technical explanation of the removal process is [here](https://publicsatanicvoid.github.io/WindowsPowerWash/docs/removing-edge), for those interested.                                             |
| Remove Windows Store | ✅ | ✅ | ✅ | Removes Windows Store. Yep, it's that simple. |

### Software Installation

| Feature                                                         | Works on Windows Home | Works on Windows Pro, Pro for Workstations | Works on Windows Enterprise, Enterprise LTSC, Education | Description                                                                                                                                                                                                                                                                                                                                                                                       |
| --------------------------------------------------------------- | :-------------------: | :------------------: | :-----------------------------------: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Install Group Policy Editor                                     |           ✅           |         N/A          |                  N/A                  | Installs [Group Policy editor](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn265982(v=ws.11)), which presents a straightforward and well-documented interface to make system changes without manually editing the registry. Group Policy editor is a Microsoft product but does not come installed by default on Home editions of Windows. |
| Install/Enable Hyper-V                                                 |           ✅           |         ✅          |                  ✅                  | Installs [Hyper-V](https://learn.microsoft.com/en-us/virtualization/hyper-v-on-windows/about/), which provides virtualization capabilities for Windows. Hyper-V is a Microsoft product but does not come installed by default on Home editions of Windows. On other editions, this will just enable the Hyper-V feature as it already exists.                                                                                                                                        |
| Install Winget                                                  |           ✅           |          ✅           |                   ✅                   | See [https://learn.microsoft.com/en-us/windows/package-manager/winget/](https://learn.microsoft.com/en-us/windows/package-manager/winget/)                                                                                                                                                                                                                                                        |
| Install free utilities and replacements for Microsoft bloatware |           ✅           |          ✅           |                   ✅                   | [This list is configurable!](https://publicsatanicvoid.github.io/WindowsPowerWash/docs/usage/config)                                                                                                                                                                                                                                                                                                  |

### Scans and checks

| Feature                             | Works on Windows Home | Works on Windows Pro, Pro for Workstations | Works on Windows Enterprise, Enterprise LTSC, Education | Description                                                                                                                                                                                                                                                |
| ----------------------------------- | :-------------------: | :------------------: | :-----------------------------------: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| System integrity checks             |           ✅           |          ✅           |                   ✅                   | Runs Microsoft's built-in [system file integrity checks](https://support.microsoft.com/en-us/topic/use-the-system-file-checker-tool-to-repair-missing-or-corrupted-system-files-79aa86cb-ca52-166a-92a3-966e85d4094e) to repair any corrupted system files |
| Check for IRQ conflicts             |           ✅           |          ✅           |                   ✅                   | Sharing interrupt request lines among multiple devices can degrade performance. This cannot be fixed from within the software.                                                                                                                             |
| Warn if third-party antivirus found |           ✅           |          ✅           |                   ✅                   | Windows Defender is generally faster and better; third-party antivirus software can slow the system down substantially - must be uninstalled manually, though                                                                                              |

## Suggestions and Tips
- For a hassle-free Windows experience with the maximum length of support, I recommend following one of the many online guides to installing Windows IoT Enterprise 2021 LTSC. It's the cleanest and most stable out-of-the-box edition of Windows. 
- I recommend you use programs like [LatencyMon](https://www.resplendence.com/latencymon) and [WhySoSlow](https://www.resplendence.com/whysoslow) to benchmark your system before and after running PowerWash and any other optimizations.
- This script should be accompanied by a manual review of preinstalled programs, devices, services, etc. to disable or uninstall unwanted software.
- Adequate thermal management is imperative to stable device functioning. Make sure your device is being cooled adequately.
- You can also overclock CPU/GPU/RAM if needed, but this is a "brute force" approach and you should try to get performance as high as possible before resorting to this. May also compromise thermals, so make sure to use long-running stability tests like [Prime95](https://www.mersenne.org/download/) (CPU, RAM), [Kombustor](https://geeks3d.com/furmark/kombustor/) (CPU, GPU), and [Memtest86](https://www.memtest86.com/) (RAM).
- Using SSD instead of HDD, and NVMe instead of SATA, can drastically improve system responsiveness and application load times, though likely won't help with most causes of high interrupt latency.
- Make sure all drivers are up to date. When installing or reinstalling, __perform clean installs where possible__.
- Always back up your system before running PowerWash or making any other system configuration changes.
- After installing a Windows update, you may need to re-run PowerWash as updates have been known to spontaneously re-enable certain features.
- Obviously, all of this is "use at your own risk"

## Special Thank-Yous
Now in README for greater visibility
